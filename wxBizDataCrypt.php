<?php
 include_once "\x65\162\x72\157\162\103\x6f\x64\x65\x2e\x70\150\x70"; class WXBizDataCrypt { private $appid; private $sessionKey; public function __construct($appid, $sessionKey) { $this->sessionKey = $sessionKey; $this->appid = $appid; } public function decryptData($encryptedData, $iv, &$data) { goto nYweC; F_Suv: $data = $result; goto ZBIBR; K1rjr: fP97l: goto OmE61; ZBIBR: return ErrorCode::$OK; goto N0BSS; RHVM1: return ErrorCode::$IllegalAesKey; goto MQLrF; oYkWR: $aesKey = base64_decode($this->sessionKey); goto zemyL; rANmt: return ErrorCode::$IllegalBuffer; goto m8TwZ; OEdtj: ZJZLX: goto F_Suv; M2KeG: if (!($dataObj == NULL)) { goto gV6_b; } goto rANmt; CrLjJ: $result = openssl_decrypt($aesCipher, "\101\105\x53\x2d\x31\62\x38\x2d\103\x42\103", $aesKey, 1, $aesIV); goto D5ZMy; BKF13: $aesCipher = base64_decode($encryptedData); goto CrLjJ; zemyL: if (!(strlen($iv) != 24)) { goto fP97l; } goto lUWr8; m8TwZ: gV6_b: goto c3S8b; lUWr8: return ErrorCode::$IllegalIv; goto K1rjr; MQLrF: VECOe: goto oYkWR; qbi7D: return ErrorCode::$IllegalBuffer; goto OEdtj; nYweC: if (!(strlen($this->sessionKey) != 24)) { goto VECOe; } goto RHVM1; c3S8b: if (!($dataObj->watermark->appid != $this->appid)) { goto ZJZLX; } goto qbi7D; D5ZMy: $dataObj = json_decode($result); goto M2KeG; OmE61: $aesIV = base64_decode($iv); goto BKF13; N0BSS: } }
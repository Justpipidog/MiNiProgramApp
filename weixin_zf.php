<?php
 goto CL0uz; dnrRE: header("\x43\157\x6e\x74\x65\x6e\164\x2d\164\x79\x70\x65\x3a\164\145\x78\x74\x2f\150\164\x6d\154\x3b\40\103\150\141\162\163\145\164\x3d\165\x74\x66\x2d\x38"); goto NcqJI; CL0uz: define("\x52\x4f\117\x54\x5f\x50\x41\124\x48", IA_ROOT . "\x2f\x61\x64\144\x6f\x6e\163\x2f\x73\x75\144\165\x38\137\160\x61\147\145\x2f"); goto dnrRE; NcqJI: class WxpayService { protected $mchid; protected $appid; protected $appKey; protected $apiKey; protected $uniacid; public $data = null; public function __construct($mchid, $appid, $appKey, $key) { goto K4L3G; eM9J9: $this->appKey = $appKey; goto oCTlU; XH0II: $this->appid = $appid; goto eM9J9; oCTlU: $this->apiKey = $key; goto scrwe; K4L3G: $this->mchid = $mchid; goto XH0II; scrwe: } private function ToUrlParams($urlObj) { goto ESjMq; r02OC: $buff = trim($buff, "\46"); goto WhC4U; W59HX: foreach ($urlObj as $k => $v) { goto KAWBN; Wh3co: X6UN4: goto kxpam; mDov9: UEahq: goto Wh3co; KAWBN: if (!($k != "\x73\151\x67\x6e")) { goto UEahq; } goto pVsOQ; pVsOQ: $buff .= $k . "\x3d" . $v . "\x26"; goto mDov9; kxpam: } goto YpsPy; WhC4U: return $buff; goto VM7YK; YpsPy: bs71r: goto r02OC; ESjMq: $buff = ''; goto W59HX; VM7YK: } public function createJsBizPackage($openid, $totalFee, $outTradeNo, $trueName, $uniacid) { goto SYBGJ; tA_yI: if (!($unifiedOrder === false)) { goto Jb1hC; } goto A6owA; A6owA: die("\xe8\xaf\xb7\xe6\xa3\200\346\x9f\245\xe7\xb3\273\347\273\x9f\55\x3e\345\xb0\217\347\xa8\213\xe5\272\217\350\256\276\347\275\xae\x2d\x3e\xe6\x94\257\xe4\xbb\230\350\256\xbe\xe7\xbd\xae\55\x3e\xe4\274\x81\344\xb8\232\xe4\xbb\230\346\254\276\xe8\256\xbe\xe7\275\xae"); goto ZPBiB; mQCT_: goto xDMHT; goto gTkNv; ZPBiB: Jb1hC: goto gruD0; ZGHP3: if (!($unifiedOrder->result_code != "\x53\125\103\103\x45\123\x53")) { goto G2Ngi; } goto vD9GL; SYBGJ: $ip = $_SERVER["\123\x45\x52\126\105\x52\137\101\104\104\x52"]; goto UZsI4; G5dXU: $unified["\163\151\x67\x6e"] = self::getSign($unified, $config["\x6b\145\171"]); goto zv68i; zv68i: $responseXml = $this->curlPost("\x68\164\x74\x70\163\x3a\x2f\57\x61\x70\151\x2e\155\x63\x68\x2e\x77\x65\x69\170\x69\156\x2e\x71\161\56\143\x6f\x6d\x2f\155\155\x70\141\171\x6d\153\x74\x74\162\x61\156\x73\146\x65\162\163\57\160\162\157\155\157\x74\151\x6f\156\57\164\162\141\x6e\x73\x66\x65\162\163", self::arrayToXml($unified), $uniacid); goto Bf_oY; LXJL9: die("\xe6\x82\xa8\xe7\x9a\x84\344\273\230\346\xac\xbe\345\270\x90\xe5\217\xb7\344\275\x99\xe9\xa2\235\xe4\270\x8d\350\266\263\346\x88\226\xe8\265\x84\xe9\x87\221\346\x9c\xaa\345\210\xb0\350\xb4\xa6"); goto sDsn3; fStzH: return true; goto R6ACP; c8emV: xDMHT: goto SWyo1; Dtskd: if ($unifiedOrder->err_code == "\120\x41\x52\x41\115\137\x45\122\122\117\122") { goto kyUie; } goto uSpFG; lDBI7: die("\xe6\xb2\241\xe6\x9c\x89\xe8\257\245\346\x8e\xa5\345\217\xa3\346\x9d\x83\xe9\231\220"); goto cuHLt; SWyo1: goto Fqr9H; goto MleMs; cuHLt: Fqr9H: goto cE0dW; gruD0: if (!($unifiedOrder->return_code != "\x53\125\x43\103\105\x53\x53")) { goto JMJc7; } goto oRV5u; cmJkZ: G2Ngi: goto fStzH; sDsn3: SgW0i: goto cmJkZ; UZsI4: $config = array("\155\x63\x68\x5f\151\144" => $this->mchid, "\x61\160\x70\x69\x64" => $this->appid, "\x6b\145\x79" => $this->apiKey); goto FdBOf; aNXwK: die("\345\217\x82\346\225\260\xe9\224\231\350\257\xaf"); goto gJBn6; Lms1a: JMJc7: goto ZGHP3; relTP: goto XQkpH; goto G00DN; vD9GL: if ($unifiedOrder->err_code == "\116\117\x54\105\x4e\117\x55\x47\110") { goto F0G7y; } goto JPw9C; cE0dW: goto SgW0i; goto O2GhC; Bf_oY: $unifiedOrder = simplexml_load_string($responseXml, "\x53\x69\x6d\160\154\x65\x58\115\114\x45\x6c\145\x6d\145\156\164", LIBXML_NOCDATA); goto tA_yI; ju16G: die("\351\x87\221\351\xa2\235\xe8\266\205\351\x99\x90"); goto c8emV; uSpFG: die($unifiedOrder->err_code); goto relTP; oRV5u: die($unifiedOrder->return_msg); goto Lms1a; G00DN: kyUie: goto aNXwK; FdBOf: $unified = array("\155\143\150\x5f\141\x70\160\x69\x64" => $config["\x61\x70\160\151\144"], "\x6d\x63\x68\x69\x64" => $config["\x6d\x63\150\137\x69\144"], "\156\x6f\x6e\x63\145\137\x73\164\x72" => self::createNonceStr(), "\157\x70\x65\156\151\x64" => $openid, "\x63\150\x65\x63\153\137\x6e\x61\x6d\x65" => "\x4e\x4f\x5f\103\x48\105\103\x4b", "\162\x65\137\x75\163\x65\x72\137\x6e\141\155\145" => $trueName, "\x70\x61\162\x74\156\x65\x72\137\164\x72\141\144\145\137\x6e\x6f" => $outTradeNo, "\x73\x70\x62\151\154\x6c\137\x63\x72\x65\141\164\x65\137\151\x70" => $ip, "\141\x6d\x6f\165\x6e\x74" => intval($totalFee * 100), "\x64\x65\163\143" => "\xe4\xbb\230\xe6\254\xbe"); goto G5dXU; JPw9C: if ($unifiedOrder->err_code == "\x4e\117\137\x41\125\124\110") { goto JRHE3; } goto GoudQ; O2GhC: F0G7y: goto LXJL9; GoudQ: if ($unifiedOrder->err_code == "\101\x4d\117\125\x4e\124\137\x4c\x49\115\x49\x54") { goto yUx9F; } goto Dtskd; gJBn6: XQkpH: goto mQCT_; MleMs: JRHE3: goto lDBI7; gTkNv: yUx9F: goto ju16G; R6ACP: } public static function curlGet($url = '', $options = array()) { goto xW8CJ; YhM4M: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); goto KPCBl; vP55E: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto YhM4M; Uk8iN: return $data; goto MiT6J; wv40A: if (empty($options)) { goto Jb3i4; } goto c8GlS; umwd5: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto i0I3q; ZRs_o: Jb3i4: goto vP55E; lQvn1: curl_close($ch); goto Uk8iN; KPCBl: $data = curl_exec($ch); goto lQvn1; xW8CJ: $ch = curl_init($url); goto umwd5; i0I3q: curl_setopt($ch, CURLOPT_TIMEOUT, 30); goto wv40A; c8GlS: curl_setopt_array($ch, $options); goto ZRs_o; MiT6J: } public function curlPost($url = '', $postData = '', $uniacid, $options = array()) { goto nAIlV; c5iMm: if (empty($options)) { goto X63hP; } goto upzcN; Grkhr: curl_setopt($ch, CURLOPT_SSLKEYTYPE, "\120\x45\x4d"); goto m4tr3; WKCG0: aaFQ6: goto XOsLz; JOil_: curl_setopt($ch, CURLOPT_SSLCERT, ROOT_PATH . "\103\x65\162\x74\x2f" . $uniacid . "\x2f\x61\160\151\x63\x6c\x69\x65\x6e\164\x5f\x63\x65\x72\x74\x2e\x70\145\155"); goto Grkhr; Q0jBR: $data = curl_exec($ch); goto kUlbv; XOsLz: $ch = curl_init(); goto Eo4GF; k0oyd: X63hP: goto iGH2V; iGH2V: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto vt6uj; nAIlV: if (!is_array($postData)) { goto aaFQ6; } goto F3Odw; M1lXt: curl_setopt($ch, CURLOPT_POST, 1); goto qV5Ka; iVSxC: curl_setopt($ch, CURLOPT_TIMEOUT, 30); goto c5iMm; l7W9b: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto M1lXt; m4tr3: curl_setopt($ch, CURLOPT_SSLKEY, ROOT_PATH . "\x43\x65\x72\164\x2f" . $uniacid . "\x2f\x61\160\151\143\x6c\x69\x65\x6e\164\x5f\153\145\x79\x2e\160\145\155"); goto Q0jBR; qV5Ka: curl_setopt($ch, CURLOPT_POSTFIELDS, $postData); goto iVSxC; kUlbv: curl_close($ch); goto fJjMB; Eo4GF: curl_setopt($ch, CURLOPT_URL, $url); goto l7W9b; F3Odw: $postData = http_build_query($postData); goto WKCG0; pxdhi: curl_setopt($ch, CURLOPT_SSLCERTTYPE, "\x50\x45\x4d"); goto JOil_; vt6uj: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); goto pxdhi; upzcN: curl_setopt_array($ch, $options); goto k0oyd; fJjMB: return $data; goto lh09y; lh09y: } public static function createNonceStr($length = 16) { goto TVm4o; H6dYe: $i = 0; goto xi8cv; kKKxT: $i++; goto x9JST; TVm4o: $chars = "\141\142\143\x64\145\146\147\150\x69\152\153\x6c\155\156\x6f\160\161\x72\x73\164\165\166\x77\x78\171\x7a\101\102\x43\104\x45\106\x47\110\x49\x4a\x4b\114\115\x4e\117\x50\x51\x52\x53\124\x55\x56\127\130\131\x5a\60\x31\x32\x33\x34\65\66\67\70\x39"; goto MRtXr; x9JST: goto rA2Zl; goto ZhpeZ; RPXYJ: c9VsC: goto kKKxT; ghW84: $str .= substr($chars, mt_rand(0, strlen($chars) - 1), 1); goto RPXYJ; aMga7: if (!($i < $length)) { goto nUnCX; } goto ghW84; AoUqF: return $str; goto u7gQ1; xi8cv: rA2Zl: goto aMga7; MRtXr: $str = ''; goto H6dYe; ZhpeZ: nUnCX: goto AoUqF; u7gQ1: } public static function arrayToXml($arr) { goto UxSg3; enVgn: foreach ($arr as $key => $val) { goto AC63U; Kbuox: $xml .= "\x3c" . $key . "\x3e" . $val . "\74\57" . $key . "\x3e"; goto WkXeh; teJYK: JxgTe: goto Kbuox; WkXeh: xUhF3: goto Onh6B; FOSCD: $xml .= "\74" . $key . "\x3e\74\x21\x5b\x43\104\101\124\x41\x5b" . $val . "\135\x5d\x3e\74\x2f" . $key . "\76"; goto qypGC; AC63U: if (is_numeric($val)) { goto JxgTe; } goto FOSCD; Onh6B: Mh2bJ: goto xwUW9; qypGC: goto xUhF3; goto teJYK; xwUW9: } goto uSy1i; iNBW0: $xml .= "\x3c\x2f\170\x6d\154\x3e"; goto uGdaB; UxSg3: $xml = "\74\170\155\154\76"; goto enVgn; uGdaB: return $xml; goto iAlVz; uSy1i: dEzxL: goto iNBW0; iAlVz: } public static function getSign($params, $key) { goto Lv1h0; Lv1h0: ksort($params, SORT_STRING); goto jDRMQ; IJxw8: return $signStr; goto rfhqq; jDRMQ: $unSignParaString = self::formatQueryParaMap($params, false); goto IDZAk; IDZAk: $signStr = strtoupper(md5($unSignParaString . "\46\x6b\145\x79\x3d" . $key)); goto IJxw8; rfhqq: } protected static function formatQueryParaMap($paraMap, $urlEncode = false) { goto MlLpD; s4LBD: MMbn1: goto Q5cUb; rYPtE: ksort($paraMap); goto tAVIR; tAVIR: foreach ($paraMap as $k => $v) { goto ejtXn; RHfKZ: $v = urlencode($v); goto GvRHI; sHklF: if (!$urlEncode) { goto a0P0m; } goto RHfKZ; ejtXn: if (!(null != $v && "\156\165\154\154" != $v)) { goto FFsVW; } goto sHklF; cdcny: $buff .= $k . "\75" . $v . "\x26"; goto uME1l; u8Q2v: Hgg0D: goto tUL07; uME1l: FFsVW: goto u8Q2v; GvRHI: a0P0m: goto cdcny; tUL07: } goto s4LBD; dgzcm: if (!(strlen($buff) > 0)) { goto tqN3J; } goto JyJgA; Q5cUb: $reqPar = ''; goto dgzcm; JyJgA: $reqPar = substr($buff, 0, strlen($buff) - 1); goto arMMn; MlLpD: $buff = ''; goto rYPtE; arMMn: tqN3J: goto gnYvp; gnYvp: return $reqPar; goto ZJgGI; ZJgGI: } }